Links: ~select:-:Select a subject!selected disabled hidden|S-Joan:Mum|SRonald:Dad|T-Music:Favourite music|T-Films:Favourite films|T-Technology:The Geek's Progress~~space:3~Next: ~tid:Career3:Windrush Micro Systems~

## Assemblers and compilers

Each generation of technology is built on the backs of the previous ones; nothing is ever built from scratch. This makes for a rapid rate of development but also for a considerable degree of vulnerability that's hard to spot. The whole of the Internet - and with it the rest of our society - is dependent on everything working and going on working. A sobering thought. Here's an amusing illustration from the online comic [xkcd.com](https://xkcd.com) illustrating the problem:

~img:dependency.png:center 25%~

Modern programmers are used to pulling software components from the Internet and integrating them into their own projects, but when I started there was no Internet and few other places to discover how things should be done. I developed my own ways of doing things and the software techniques I've used over the past 4 decades are in many ways little changed from when I started. This no doubt explains why in my later years I found it hard to fit into teams of programmers; I was used to doing things my own way.

Among the first of my projects was an assembler for the 6800 microprocessor, which included its own text editor so that only one program had to be loaded. The editor was line oriented; it didn't rely on a directly addressable screen. The system itself included the miniature Phillips digital tape drives. I built 3 computers, one for myself and one for each of a couple of colleagues/friends who had helped design and build parts of the system. At some point along the way I replaced the line editor with a screen version that would be familiar to people used to vi or emacs. Mine was a lot simpler and more friendly, though. Every command started with Escape, so to open a file you had Escape O, to save Escape S, to assemble Escape A and so on. If you hit Escape twice a table would pop up showing all the options available, so there was nothing to remember.

At the end of the 1970s I'd gotten associated with Windrush Micro Systems, a small and rather amateurish industrial control systems company in Norfolk, who imported American 6800-based computer systems that used floppy disc drives and ran the Flex operating system. My team at British Telecom bought a couple of these systems to control the experiments we ran and I quickly adapted my assembler to use the floppy discs rather than the tape drives. I gradually developed a friendship with the people at Windrush and they used my assembler in their own projects.

My memory is a little hazy on the precise sequence of events. In 1978, Motorola introduced the 6809, a considerable improvement on the earlier 6800. I immediately wrote a cross-assembler to run on Flex, then as soon as there was a 6809 version of the latter I wrote a full assembler for the newer processor. At about that time, the owner of Windrush, Jim Dady, combined forces with an old friend, Bill Dickinson, an assertive New Yorker who wanted to make the company a lot more commercial. I used to visit the factory in North Walsham quite regularly and on one visit we became engaged in a discussion about the current state of high-level language software. At the time, C was a new language and there were no industrial-strength compilers for it. PL/M was around but not for the 6809, and Bill asked me how hard it could be to write a high-level language of that kind. I said - in all honesty - that I had little idea but I'd take away the question and consider it.

I dove right in and spent the next few weeks devising how to implement a compiler. Not knowing either C or PL/M I devised  an arbitrary high-level syntax in the same general area and called it PL/9. I had no formal knowledge of how to write a compiler, either, so I approached it the same way I'd done for the assemblers; from the top down. I looked at typical commands such as A = B + C, translated them into the equivalent machine code and figured out how I'd done it. Then I wrote code that did as far as possible what I'd done in my head. [This is way different to the way most compilers are written; they start by analysing commands and building all kinds of formal representations before doing any actual translation. But I'd never learned how to do that.]

It must have taken a year or so to get PL/9 into a usable form. It included the screen editor and a single-step tracer/debugger that let you step through the program one source line at a time, and all this fitted into 16k bytes of memory, leaving room for a decent sized program to be edited, compiled and run. It was far simpler to use than any competing compiler, it compiled very quickly and the code it produced outperformed all of the others, so it was quite a hit with Flex users around the world and we sold over 1000 copies; a decent achievement for such a small company.

With the introduction of the 68000 processor at the end of the 1980s I rewrote PL/9 as PLuS-68k, much of it while off work recovering from appendicitis; not the best of things to contract in your late thirties. By this time I was very close to the people at Windrush so it was no surprise when I decided to leave BT and join them instead. I've written about that period ~tid:Career3:elsewhere in these memoirs~.

My timing in going to Windrush was pretty disastrous. The recession of the early 1990s almost wiped out the company and a year later I was about to lose my job. By a lucky stroke of fate another local company was looking for someone with my skills, so after just a year at Windrush I joined Backs Electronic Publishing (BEPL) to work on software products for the new ~tid:Career4:Philips CD-Interactive system~.

The software available for CD-i developers was pretty primitive, comprising a set of massively complex C libraries and a compiler to create the binary code for the 68000 processor used in the devices. Although C is a powerful language it's hard to cram a large amount of logic into a small amount of memory, so we kept running out of room as the program grew. Much of the problem was the bulky code being needed to do something conceptually simple like a fade, to play audio or simply to put something on the screen.

What was needed was some way to reuse the program space as needed. Since multimedia titles are very much a case of "do this, then this, then this..." so I had the idea of building a list of "this" instructions that could be run by a small program module. Instead of having a copy of the same code each time we wanted a fade there would be a single instance of the code that would be used as a library function each time. This approach had the massive extra benefit that the intermediate code was just a text file so it could be loaded and unloaded on demand, allowing us to create a program of almost unlimited size. Without realising it at the time I'd devised what would now be termed an "intermediate language"; something that expresses the logic of a program without being tied to any given computer architecture.

One thing led to another and over a period of about 3 months I had added a set of English-like instructions with a compiler that converted them into my intermediate code. I remember I said nothing about all this to Robin, the owner of BEPL, until it was a _fait accompli_, then sprang it on him with the claim that it could easily do all that was needed. To his credit, after a short period of what must hve been complete panic he let me go ahead with the idea. Fortunately it turned out to have been the right approach and over the next couple of years we built a handful of "titles", most notably a range of discs for Waitrose with which to train their checkout till operators. Unfortunately, CD-Interactive was not destined to last, so a couple of years later I rewrote the tools for Microsoft Windows. We transferred a couple of our old CD-i titles and built several more. The one that presented the most challenges was for Sky's short-lived technology channel, [.tv], who had devised a game show called [The Nexus](http://www.ukgameshows.com/ukgs/Nexus), hosted by Brian Blessed. The contestants had to play simple computer games and we got the job of building those games.

Links: ~select:-:Select a subject!selected disabled hidden|S-Joan:Mum|SRonald:Dad|T-Music:Favourite music|T-Films:Favourite films|T-Technology:The Geek's Progress~~space:3~Next: ~tid:Career3:Windrush Micro Systems~
